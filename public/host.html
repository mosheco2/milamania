<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>××™×œ×× ×™×” - × ×™×”×•×œ ××©×—×§</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Varela+Round&display=swap" rel="stylesheet">

  <style>
    :root {
      font-size: 16px;
    }

    * {
      box-sizing: border-box;
      font-family: "Varela Round", system-ui, -apple-system, BlinkMacSystemFont,
        "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #1f2937 0, #020617 52%, #000 100%);
      color: #e5e7eb;
    }

    .app {
      max-width: 1150px;
      margin: 0 auto;
      padding: 14px 10px 40px;
    }

    .card {
      background: radial-gradient(circle at top left, rgba(129, 140, 248, 0.1), rgba(15, 23, 42, 0.96));
      border-radius: 18px;
      padding: 14px 14px 16px;
      margin-bottom: 14px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      box-shadow:
        0 22px 45px rgba(15, 23, 42, 0.8),
        0 0 0 1px rgba(15, 23, 42, 0.7) inset;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }

    .card-header h2,
    .card-header h3 {
      margin: 0;
      font-size: 1.15rem;
    }

    .card-subtitle {
      font-size: 0.86rem;
      color: #9ca3af;
      margin-top: 4px;
    }

    h1, h2, h3, h4 {
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    label {
      display: inline-block;
      font-size: 0.9rem;
      color: #e5e7eb;
      margin-bottom: 4px;
    }

    input[type="text"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 8px 9px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.9);
      color: #e5e7eb;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
    }

    input::placeholder,
    textarea::placeholder {
      color: #6b7280;
    }

    input:focus,
    select:focus,
    textarea:focus {
      border-color: #f97316;
      box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.4);
      background: rgba(15, 23, 42, 0.98);
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
    }

    .row > .col {
      flex: 1;
      min-width: 0;
    }

    .row-3 {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
    }

    .row-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .field {
      margin-bottom: 10px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      border-radius: 999px;
      border: none;
      padding: 9px 14px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #f97316, #ec4899);
      color: #0b1120;
      box-shadow:
        0 14px 35px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(248, 250, 252, 0.03) inset;
      transition:
        transform 0.1s ease,
        box-shadow 0.14s ease,
        filter 0.14s ease,
        background 0.14s ease;
      white-space: nowrap;
    }

    .btn:hover:not(:disabled) {
      transform: translateY(-1px);
      filter: brightness(1.03);
      box-shadow:
        0 20px 45px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(248, 250, 252, 0.05) inset;
    }

    .btn:active:not(:disabled) {
      transform: translateY(0);
      box-shadow:
        0 10px 25px rgba(15, 23, 42, 0.9),
        0 0 0 1px rgba(248, 250, 252, 0.06) inset;
    }

    .btn:disabled {
      opacity: 0.55;
      cursor: not-allowed;
      filter: grayscale(0.2);
      background: radial-gradient(circle at top left, #4b5563, #1f2937);
      color: #9ca3af;
      box-shadow: none;
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.63);
      color: #e5e7eb;
      box-shadow: none;
    }

    .btn-ghost:hover:not(:disabled) {
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.18), transparent);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.7);
    }

    .btn-danger {
      background: radial-gradient(circle at top, #ef4444, #b91c1c);
      color: #fef2f2;
    }

    .btn-success {
      background: radial-gradient(circle at top left, #22c55e, #16a34a);
      color: #ecfdf5;
    }

    .btn-small {
      padding: 5px 10px;
      font-size: 0.8rem;
    }

    .inline-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: #e5e7eb;
    }

    .inline-badge strong {
      color: #f97316;
    }

    .status-text {
      font-size: 0.86rem;
      color: #cbd5f5;
      line-height: 1.5;
    }

    .status-text strong {
      color: #f97316;
    }

    .status-error {
      color: #fecaca;
    }

    .status-ok {
      color: #bbf7d0;
    }

    .status-muted {
      color: #9ca3af;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 9px;
      border-radius: 999px;
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.18), rgba(15, 23, 42, 0.95));
      border: 1px solid rgba(94, 234, 212, 0.5);
      color: #e0f2fe;
    }

    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .page-header-main {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .top-tabs {
      display: inline-flex;
      padding: 2px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.9));
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.9);
    }

    .top-tabs button {
      background: transparent;
      border: none;
      color: #9ca3af;
      font-size: 0.86rem;
      padding: 5px 10px;
      border-radius: 999px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-weight: 600;
      transition:
        background 0.12s ease,
        color 0.12s ease,
        transform 0.12s ease;
    }

    .top-tabs button.active {
      background: radial-gradient(circle at top left, #4f46e5, #ec4899);
      color: #f9fafb;
      box-shadow: 0 10px 22px rgba(15, 23, 42, 0.95);
      transform: translateY(-1px);
    }

    .top-tabs button:hover:not(.active) {
      background: radial-gradient(circle at top, rgba(30, 64, 175, 0.8), transparent);
      color: #e5e7eb;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      font-size: 0.76rem;
      color: #e5e7eb;
      background: rgba(15, 23, 42, 0.9);
    }

    .pill span.label {
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-size: 0.7rem;
    }

    .pill span.value {
      color: #f9fafb;
    }

    .badge-pill-info {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.7);
      font-size: 0.75rem;
      background: radial-gradient(circle at top left, rgba(56, 189, 248, 0.25), rgba(15, 23, 42, 0.95));
      color: #e0f2fe;
    }

    .badge-pill-info span.label {
      text-transform: uppercase;
      letter-spacing: 0.08em;
      opacity: 0.9;
    }

    .badge-pill-info span.value {
      font-weight: 600;
      color: #f9fafb;
    }

    .section-title {
      font-size: 0.9rem;
      margin: 0 0 4px;
      color: #e5e7eb;
    }

    .section-subtitle {
      font-size: 0.8rem;
      color: #9ca3af;
      margin: 0 0 6px;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .pill-row > * {
      margin-bottom: 2px;
    }

    .danger-zone {
      border: 1px dashed rgba(248, 113, 113, 0.7);
      background: radial-gradient(circle at top left, rgba(127, 29, 29, 0.2), rgba(15, 23, 42, 0.96));
      padding: 10px;
      border-radius: 12px;
    }

    .danger-zone h4 {
      margin: 0 0 4px;
      font-size: 0.9rem;
      color: #fecaca;
    }

    .danger-zone p {
      margin: 0 0 6px;
      font-size: 0.8rem;
      color: #fecaca;
    }

    .danger-zone-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
    }

    .badge-soft {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      border: 1px dashed rgba(148, 163, 184, 0.7);
    }

    .badge-soft span.label {
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-size: 0.7rem;
    }

    .badge-soft span.value {
      color: #f97316;
      font-weight: 600;
    }

    .grid-2 {
      display: grid;
      gap: 10px;
      grid-template-columns: minmax(0, 1.05fr) minmax(0, 0.95fr);
    }

    .grid-stats {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      margin: 4px 0 2px;
    }

    .stat-pill {
      border-radius: 14px;
      padding: 6px 8px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.95), rgba(15, 23, 42, 0.9));
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.8rem;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .stat-pill-label {
      font-size: 0.7rem;
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .stat-pill-value {
      font-size: 0.95rem;
      color: #e5e7eb;
      font-weight: 600;
    }

    .tags-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag {
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
    }

    .tag span {
      color: #9ca3af;
    }

    .tag strong {
      color: #f97316;
    }

    .input-inline-group {
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .input-inline-group input[type="number"] {
      max-width: 90px;
    }

    .input-inline-group .suffix {
      font-size: 0.85rem;
      color: #9ca3af;
    }

    .list-compact {
      margin: 4px 0;
      padding-left: 1.2em;
      font-size: 0.85rem;
      color: #cbd5f5;
    }

    .list-compact li {
      margin-bottom: 2px;
    }

    .inline-note {
      font-size: 0.78rem;
      color: #9ca3af;
      margin-top: 3px;
    }

    .inline-note strong {
      color: #e5e7eb;
    }

    .hidden {
      display: none !important;
    }

    .flex {
      display: flex;
    }

    .flex-between {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .flex-center {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .gap-4 { gap: 4px; }
    .gap-6 { gap: 6px; }
    .gap-8 { gap: 8px; }
    .gap-10 { gap: 10px; }

    .mt-0 { margin-top: 0; }
    .mt-2 { margin-top: 2px; }
    .mt-4 { margin-top: 4px; }
    .mt-6 { margin-top: 6px; }
    .mt-8 { margin-top: 8px; }
    .mt-10 { margin-top: 10px; }

    .mb-0 { margin-bottom: 0; }
    .mb-2 { margin-bottom: 2px; }
    .mb-4 { margin-bottom: 4px; }
    .mb-6 { margin-bottom: 6px; }
    .mb-8 { margin-bottom: 8px; }
    .mb-10 { margin-bottom: 10px; }

    .text-center { text-align: center; }
    .text-right { text-align: right; }

    .text-muted { color: #9ca3af; }
    .text-soft { color: #cbd5f5; }

    .highlight {
      color: #f97316;
      font-weight: 600;
    }

    .score-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 8px;
      border-radius: 10px;
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.95), rgba(30, 64, 175, 0.9));
      border: 1px solid rgba(129, 140, 248, 0.75);
      margin-bottom: 4px;
    }

    .score-row-name {
      font-size: 0.95rem;
      font-weight: 600;
      color: #e5e7eb;
    }

    .score-row-points {
      font-size: 1.1rem;
      font-weight: 700;
      color: #fbbf24;
    }

    .score-row-controls {
      display: flex;
      gap: 4px;
      align-items: center;
    }

    .score-row-controls button {
      padding: 3px 7px;
      font-size: 0.75rem;
    }

    .players-by-team-list {
      font-size: 0.86rem;
      color: #cbd5f5;
    }

    .players-by-team-list h4 {
      margin: 4px 0;
      font-size: 0.88rem;
      color: #e5e7eb;
    }

    .players-by-team-list ul {
      list-style: none;
      padding: 0;
      margin: 0 0 6px;
    }

    .players-by-team-list li {
      margin-bottom: 2px;
    }

    .players-by-team-list .empty {
      color: #6b7280;
      font-style: italic;
    }

    .divider-soft {
      border: none;
      border-top: 1px solid rgba(148, 163, 184, 0.35);
      margin: 8px 0;
    }

    .pill-status-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
    }

    .big-timer {
      font-size: 2.3rem;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-align: center;
      color: #f97316;
      text-shadow:
        0 0 22px rgba(249, 115, 22, 0.7),
        0 0 50px rgba(56, 189, 248, 0.3);
      margin: 2px 0 4px;
    }

    .badge-tiny {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 1px 6px;
      border-radius: 999px;
      font-size: 0.68rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(15, 23, 42, 0.96);
      color: #9ca3af;
    }

    .badge-tiny strong {
      color: #e5e7eb;
    }

    .pill-inline {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.78rem;
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
    }

    .pill-inline span.label {
      color: #9ca3af;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-size: 0.72rem;
    }

    .pill-inline span.value {
      color: #f97316;
      font-weight: 600;
    }

    .pill-soft {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.78rem;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: #e5e7eb;
    }

    .pill-soft span {
      color: #9ca3af;
    }

    .pill-soft strong {
      color: #f97316;
    }

    .presenter-word {
      font-size: 2.4rem;
      text-align: center;
      margin: 4px 0 2px;
      color: #f9fafb;
      text-shadow:
        0 0 24px rgba(56, 189, 248, 0.7),
        0 0 70px rgba(15, 23, 42, 1);
    }

    .presenter-category {
      font-size: 0.9rem;
      text-align: center;
      color: #c4b5fd;
      margin-bottom: 6px;
    }

    .presenter-actions {
      display: flex;
      gap: 6px;
      justify-content: center;
      margin-top: 4px;
    }

    .presenter-actions .btn {
      min-width: 110px;
    }

    .presenter-actions .btn-secondary {
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.96), rgba(30, 64, 175, 0.9));
      color: #e5e7eb;
      border: 1px solid rgba(148, 163, 184, 0.8);
      box-shadow: 0 12px 25px rgba(15, 23, 42, 0.9);
    }

    .presenter-actions .btn-secondary:hover:not(:disabled) {
      background: radial-gradient(circle at top left, rgba(30, 64, 175, 0.9), rgba(15, 23, 42, 0.96));
    }

    .logo-small {
      width: 38px;
      height: 38px;
      border-radius: 12px;
      object-fit: contain;
      background: radial-gradient(circle at top left, #f97316, #1f2937);
      box-shadow:
        0 12px 25px rgba(15, 23, 42, 0.95),
        0 0 0 1px rgba(15, 23, 42, 0.9) inset;
    }

    .logo-small.hidden {
      display: none;
    }

    /* ×›×¤×ª×•×¨×™× ×¦×¤×™× ×œ××¢×‘×¨ ××”×™×¨ ×‘×™×Ÿ ××¦×‘×™ ×× ×”×œ/×©×—×§×Ÿ */
    .floating-switch-btn {
      position: fixed;
      inset-inline-end: 16px;
      inset-block-end: 16px;
      z-index: 999;
      padding: 10px 14px;
      border-radius: 999px;
      background: linear-gradient(135deg, #4f46e5, #ec4899);
      color: #f9fafb;
      font-size: 0.9rem;
      font-weight: 600;
      box-shadow: 0 10px 30px rgba(15, 23, 42, 0.7);
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      border: none;
      outline: none;
      transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.15s ease;
    }
    .floating-switch-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 14px 40px rgba(15, 23, 42, 0.9);
    }
    .floating-switch-btn.hidden {
      opacity: 0;
      pointer-events: none;
    }
    @media (max-width: 640px) {
      .floating-switch-btn {
        inset-inline-end: 10px;
        inset-block-end: 10px;
        padding: 8px 12px;
        font-size: 0.8rem;
      }
    }

    @media (max-width: 960px) {
      .grid-2 {
        grid-template-columns: minmax(0, 1fr);
      }
      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }
      .page-header-main {
        width: 100%;
      }
    }

    @media (max-width: 720px) {
      .row-3 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .grid-stats {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      h1 {
        font-size: 1.4rem;
      }
      .app {
        padding: 10px 10px 40px;
      }
    }

    @media (max-width: 520px) {
      .row-3 {
        grid-template-columns: minmax(0, 1fr);
      }
      .row-2 {
        grid-template-columns: minmax(0, 1fr);
      }
      .page-header {
        align-items: stretch;
      }
      .page-header-main {
        flex-direction: row;
        align-items: center;
      }
      .grid-stats {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .top-tabs {
        width: 100%;
        justify-content: space-between;
      }
    }

    @media (max-width: 420px) {
      .score-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 4px;
      }
      .score-row-controls {
        width: 100%;
        justify-content: space-between;
      }
      .presenter-actions {
        flex-direction: column;
      }
      .presenter-actions .btn {
        width: 100%;
      }
    }

    @media (max-width: 360px) {
      :root { font-size: 15px; }
      label { font-size: 0.9rem; }
      input, select { font-size: 1rem; }
      .btn { font-size: 1rem; padding: 10px 16px; }
      #roundTimer { font-size: 2rem; text-align: center; margin-top: 8px; }
      .team-row { font-size: 0.98rem; }
      .team-players { font-size: 0.85rem; }
      #hostPresenterWord { font-size: 2.1rem; }
      #hostPlayerBigTimer { font-size: 1.9rem; }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- ×›×•×ª×¨×ª ×¢×œ×™×•× ×” -->
    <div class="card" id="hostTop">
      <div class="page-header">
        <div class="page-header-main">
          <img id="host-logo" class="logo-small hidden" alt="××™×œ×× ×™×” ×œ×•×’×•" />
          <div>
            <div class="chip">××™×œ×× ×™×” Â· × ×™×”×•×œ ××©×—×§ ğŸ‘‘</div>
            <h1 style="margin:4px 0 0; font-size:1.7rem;">×× ×”×œ ×”××©×—×§</h1>
          </div>
        </div>
        <div style="display:flex; flex-direction:column; gap:6px; align-items:flex-end;">
          <div class="top-tabs">
            <button id="tabHost" class="active" type="button">ğŸ‘‘ ××¦×‘ ×× ×”×œ</button>
            <button id="tabPlayer" type="button">ğŸ® ××¦×‘ ×©×—×§×Ÿ (×× ×™)</button>
          </div>
          <div style="display:flex; gap:6px; flex-wrap:wrap; justify-content:flex-end;">
            <button class="btn btn-ghost btn-small" onclick="location.href='instructions.html'">â” ×”×•×¨××•×ª</button>
            <button class="btn btn-ghost btn-small" onclick="location.href='home.html'">â¬… ××¡×š ×”×‘×™×ª</button>
          </div>
        </div>
      </div>

      <div class="grid-stats">
        <div class="stat-pill">
          <div class="stat-pill-label">×¡×˜×˜×•×¡ ××©×—×§</div>
          <div class="stat-pill-value" id="gameStatusLabel">××™×Ÿ ××©×—×§ ×¤×¢×™×œ</div>
        </div>
        <div class="stat-pill">
          <div class="stat-pill-label">×§×•×“ ××©×—×§</div>
          <div class="stat-pill-value" id="gameCodeLabel">- - - -</div>
        </div>
        <div class="stat-pill">
          <div class="stat-pill-label">×ª×¦×•×’×”</div>
          <div class="stat-pill-value">
            <span class="inline-badge">
              <span>ğŸ‘ï¸</span>
              <span id="viewModeLabel">××¡×š ×× ×”×œ</span>
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- ××¦×‘ ×× ×”×œ -->
    <div id="hostMode">
      <div class="grid-2">
        <!-- ×›×¨×˜×™×¡ ×”×’×“×¨×•×ª ××©×—×§ -->
        <div class="card">
          <div class="card-header">
            <div>
              <h2>×”×’×“×¨×ª ××©×—×§ ×—×“×©</h2>
              <p class="card-subtitle">
                ××œ× ××ª ×¤×¨×˜×™ ×”×× ×”×œ, ×§×•×“×§×‘×•×¦×•×ª ×•×”×’×“×¨×•×ª ×‘×¨×™×¨×ª ××—×“×œ. ××—×¨×™ ×™×¦×™×¨×ª ×”××©×—×§ ×ª×§×‘×œ ×§×•×“ ×•×ª×•×›×œ ×œ×”×–××™×Ÿ ×©×—×§× ×™×.
              </p>
            </div>
            <div class="pill">
              <span class="label">×¡×˜×˜×•×¡</span>
              <span class="value" id="hostGameStatus">××™×Ÿ ××©×—×§ ×¤×¢×™×œ</span>
            </div>
          </div>

          <div class="field">
            <label for="hostName">×©× ×× ×”×œ ×”××©×—×§</label>
            <input id="hostName" type="text" placeholder="×œ××©×œ: ××©×” / × ×•×¢× / ×©×¨×•×Ÿ" />
          </div>

          <div class="row-2">
            <div class="field">
              <label for="targetScore">× ×™×§×•×“ ×™×¢×“ ×œ× ×™×¦×—×•×Ÿ</label>
              <div class="input-inline-group">
                <input id="targetScore" type="number" min="10" max="300" step="5" value="40" />
                <span class="suffix">× ×§×•×“×•×ª</span>
              </div>
              <div class="inline-note">
                <strong>×”××œ×¦×”:</strong> ×‘×™×Ÿ 30 ×œÖ¾60 × ×§×•×“×•×ª × ×•×ª×Ÿ ××©×—×§ ×›×™×¤×™ ×•×œ× ××¨×•×š ××“×™.
              </div>
            </div>
            <div class="field">
              <label for="roundSeconds">××©×š ×¡×™×‘×•×‘</label>
              <div class="input-inline-group">
                <input id="roundSeconds" type="number" min="20" max="180" step="5" value="60" />
                <span class="suffix">×©× ×™×•×ª</span>
              </div>
              <div class="inline-note">
                ××¤×©×¨ ×œ×©× ×•×ª ××•×¨×›×™ ×¡×™×‘×•×‘ ×’× ×‘××”×œ×š ×”××©×—×§, ×œ×¤× ×™ ×›×œ ×¡×™×‘×•×‘.
              </div>
            </div>
          </div>

          <hr class="divider-soft" />

          <div class="field">
            <label>×©××•×ª ×§×‘×•×¦×•×ª</label>
            <div class="row-3">
              <div>
                <label for="teamAName">×§×‘×•×¦×” A</label>
                <input id="teamAName" type="text" placeholder="×œ××©×œ: ××“×•××™×" />
              </div>
              <div>
                <label for="teamBName">×§×‘×•×¦×” B</label>
                <input id="teamBName" type="text" placeholder="×œ××©×œ: ×›×—×•×œ×™×" />
              </div>
              <div>
                <label for="teamCName">×§×‘×•×¦×” C (××•×¤×¦×™×•× ×œ×™)</label>
                <input id="teamCName" type="text" placeholder="×œ××©×œ: ×™×¨×•×§×™×" />
              </div>
            </div>
            <div class="row-3" style="margin-top:6px;">
              <div>
                <label for="teamDName">×§×‘×•×¦×” D (××•×¤×¦×™×•× ×œ×™)</label>
                <input id="teamDName" type="text" placeholder="×œ××©×œ: ×¦×”×•×‘×™×" />
              </div>
              <div>
                <label for="teamEName">×§×‘×•×¦×” E (××•×¤×¦×™×•× ×œ×™)</label>
                <input id="teamEName" type="text" placeholder="×œ××©×œ: ×©×—×•×¨×™×" />
              </div>
              <div>
                <label>×˜×™×¤ ××”× ×™×¡×™×•×Ÿ</label>
                <div class="status-text">
                  ×©××•×ª ××¦×—×™×§×™× ××• "××©×¤×—×ª×™×™×" ××¢×œ×™× ××ª ×”×× ×¨×’×™×” ×©×œ ×”××©×—×§ ğŸ˜„
                </div>
              </div>
            </div>
          </div>

          <hr class="divider-soft" />

          <div class="field">
            <label>×§×˜×’×•×¨×™×•×ª ××™×œ×™× (××•×¤×¦×™×•× ×œ×™)</label>
            <p class="section-subtitle">
              ×‘×©×œ×‘ ×¨××©×•×Ÿ ××¤×©×¨ ×œ×”×©××™×¨ ××ª ×‘×¨×™×¨×ª ×”××—×“×œ ×©×œ ×”××©×—×§. ×‘×”××©×š × ×•×¡×™×£ ××¤×©×¨×•×ª ×œ×‘×—×•×¨ ×§×˜×’×•×¨×™×•×ª.
            </p>
            <div class="tags-row">
              <span class="tag"><span>×‘×¨×™×¨×ª ××—×“×œ:</span> <strong>××™×§×¡ ×›×œ×œ×™</strong></span>
              <span class="tag"><span>×™×œ×“×™×:</span> <strong>×¤×©×•×˜ ×•×§×¦×¨</strong></span>
              <span class="tag"><span>××©×¤×—×”:</span> <strong>×›×•×œ× ××©×ª×ª×¤×™×</strong></span>
            </div>
          </div>

          <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
            <div class="status-text" id="hostStatus">
              ×¢×•×“ ×œ× × ×•×¦×¨ ××©×—×§. ××œ× ××ª ×”×¤×¨×˜×™× ×•×œ×—×¥ ×¢×œ "×¦×•×¨ ××©×—×§".
            </div>
            <button id="createGameBtn" class="btn">
              ğŸš€ ×¦×•×¨ ××©×—×§ ×—×“×©
            </button>
          </div>
        </div>

        <!-- ×›×¨×˜×™×¡ ×§×•×“ ××©×—×§ ×•×”×–×× ×•×ª -->
        <div class="card">
          <div class="card-header">
            <div>
              <h2>×§×•×“ ××©×—×§ ×•×”×–×× ×ª ×©×—×§× ×™×</h2>
              <p class="card-subtitle">
                ××—×¨×™ ×™×¦×™×¨×ª ×”××©×—×§, ×©×œ×— ××ª ×”×§×•×“ ××• ×§×™×©×•×¨ ×”×”×¦×˜×¨×¤×•×ª ×œ×©×—×§× ×™×. × ×™×ª×Ÿ ×œ×”×–××™×Ÿ ×œ×¤×™ ×§×‘×•×¦×”.
              </p>
            </div>
            <div class="pill">
              <span class="label">×—×“×¨×™×</span>
              <span class="value" id="roomsSummaryLabel">-</span>
            </div>
          </div>

          <div id="gameCodeRow" class="field hidden">
            <label>×§×•×“ ××©×—×§</label>
            <div class="flex-between">
              <div class="pill-inline">
                <span class="label">×§×•×“</span>
                <span class="value" id="gameCodeDisplay">----</span>
              </div>
              <button id="copyGameLinkBtn" class="btn btn-ghost btn-small">
                ğŸ”— ×”×¢×ª×§ ×§×™×©×•×¨ ×©×—×§×Ÿ
              </button>
            </div>
            <div class="inline-note">
              ×©×œ×— ××ª ×”×§×™×©×•×¨ ×‘×•×•××˜×¡××¤ ××• ×‘×›×œ ×“×¨×š ×©× ×•×—×” ×œ×š. ×”×©×—×§×Ÿ ×™×™×›× ×¡ ×™×©×™×¨×•×ª ×œ××¡×š ×”×”×¦×˜×¨×¤×•×ª.
            </div>
          </div>

          <hr class="divider-soft" />

          <div class="field">
            <div class="section-title">×”×–×× ×” ×œ×¤×™ ×§×‘×•×¦×”</div>
            <p class="section-subtitle">
              ×ª×•×›×œ ×œ×©×œ×•×— ×§×™×©×•×¨ ×™×™×—×•×“×™ ×œ×›×œ ×§×‘×•×¦×”. ×”×©×—×§×Ÿ ×™×§×‘×œ ×”×•×“×¢×” ×¢× ×©× ×”×§×‘×•×¦×” ×©×œ×•.
            </p>

            <div class="row-2">
              <div>
                <label for="inviteTeamSelect">×‘×—×¨ ×§×‘×•×¦×” ×œ×”×–×× ×”</label>
                <select id="inviteTeamSelect">
                  <option value="">×‘×—×¨ ×§×‘×•×¦×”...</option>
                </select>
              </div>
              <div style="display:flex; align-items:flex-end; justify-content:flex-end;">
                <button id="whatsappInviteBtn" class="btn btn-success" style="width:100%;">
                  ğŸ“² ×©×œ×™×—×ª ×”×–×× ×” ×‘×•×•××˜×¡××¤
                </button>
              </div>
            </div>
            <div class="inline-note">
              ×”×§×™×©×•×¨ ×™×©×œ×— ×¢× ×©× ×”×§×‘×•×¦×”. ×”×©×—×§×Ÿ ×¨×§ ×™××©×¨ ××ª ×©××• ×•×™×™×›× ×¡ ×œ××©×—×§.
            </div>
          </div>

          <hr class="divider-soft" />

          <div class="danger-zone">
            <h4>×¡×™×•× ××©×—×§</h4>
            <p>
              ×¡×’×™×¨×ª ×”××©×—×§ ×ª××—×§ ××ª ×›×œ ×”××™×“×¢ ×¢×œ ×”×¡×™×‘×•×‘×™× ×•×”× ×™×§×•×“, ×•×ª× ×ª×§ ××ª ×›×œ ×”×©×—×§× ×™× ××”×—×“×¨.
            </p>
            <div class="danger-zone-actions">
              <span class="badge-soft">
                <span class="label">×˜×™×¤</span>
                <span class="value">××•××œ×¥ ×œ×¡×™×™× ××©×—×§ ×¨×§ ××—×¨×™ ×©×¡×™×›××ª× ××ª ×”×ª×•×¦××” ×¢× ×›×•×œ×.</span>
              </span>
              <button id="endGameBtn" class="btn btn-danger btn-small">
                ğŸ›‘ ×¡×™×•× ×”××©×—×§
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ××–×•×¨ ×¡×™×‘×•×‘ ×•× ×™×§×•×“ -->
      <div class="card">
        <div class="card-header">
          <div>
            <h2>× ×™×”×•×œ ×¡×™×‘×•×‘×™× ×•× ×™×§×•×“</h2>
            <p class="card-subtitle">
              ×›××Ÿ ××ª×” ×©×•×œ×˜ ×¢×œ ×ª×—×™×œ×ª ×”×¡×™×‘×•×‘, ×”××¡×‘×™×¨, ×”×§×‘×•×¦×” ×•×”×ª×–××•×Ÿ. ×‘×¡×™×•× ×¡×™×‘×•×‘ ×”× ×™×§×•×“ ×™×ª×•×•×¡×£ ×œ×§×‘×•×¦×”.
            </p>
          </div>
          <div class="pill-status-row">
            <span class="pill-inline">
              <span class="label">××¦×‘ ×¡×™×‘×•×‘</span>
              <span class="value" id="roundStateLabel">××™×Ÿ ×¡×™×‘×•×‘ ×¤×¢×™×œ</span>
            </span>
            <span class="badge-tiny">
              <span>â±</span>
              <strong id="roundSecondsLabel">60 ×©× ×™×•×ª</strong>
            </span>
          </div>
        </div>

        <div class="grid-2">
          <div>
            <div class="field">
              <label for="roundTeamSelect">×§×‘×•×¦×” ×‘×¡×™×‘×•×‘</label>
              <select id="roundTeamSelect">
                <option value="">×‘×—×¨ ×§×‘×•×¦×” ×œ×¡×™×‘×•×‘...</option>
              </select>
            </div>

            <div class="field">
              <label for="explainerSelect">××™ ×”××¡×‘×™×¨/×”?</label>
              <select id="explainerSelect">
                <option value="">×‘×—×™×¨×ª ××¡×‘×™×¨/×” ××ª×•×š ×”×§×‘×•×¦×”</option>
              </select>
              <div class="inline-note">
                ×× ×œ× ×ª×‘×—×¨ ××¡×‘×™×¨, ×”××©×—×§ ×™×‘×—×¨ ××•×˜×•××˜×™×ª ××—×“ ××× ×©×™ ×”×§×‘×•×¦×”.
              </div>
            </div>

            <div class="field">
              <label for="roundSecondsInline">××©×š ×¡×™×‘×•×‘ (×©× ×™×•×ª)</label>
              <div class="input-inline-group">
                <input id="roundSecondsInline" type="number" min="20" max="180" step="5" />
                <span class="suffix">×©× ×™×•×ª</span>
              </div>
              <div class="inline-note">
                ×× ×ª×©××™×¨ ×¨×™×§, × ×©×ª××© ×‘×¢×¨×š ×‘×¨×™×¨×ª ×”××—×“×œ ××”×’×“×¨×•×ª ×”××©×—×§.
              </div>
            </div>

            <div class="field">
              <div class="section-title">×¡×˜×˜×•×¡ ×¡×™×‘×•×‘</div>
              <div id="roundStatus" class="status-text">
                ×¢×•×“ ×œ× ×”×ª×—×œ×ª× ×¡×™×‘×•×‘. ×‘×—×¨ ×§×‘×•×¦×” ×•××¡×‘×™×¨ ×•×œ×—×¥ ×¢×œ "×”×ª×—×œ ×¡×™×‘×•×‘".
              </div>
            </div>
          </div>

          <div>
            <div class="section-title">×˜×™×™××¨</div>
            <div id="roundTimer" class="big-timer">--:--</div>
            <div class="inline-note">
              ×”×˜×™×™××¨ ××¡×•× ×›×¨×Ÿ ×‘×™×Ÿ ×”×× ×”×œ ×œ×‘×™×Ÿ ×”×©×—×§×Ÿ ×”××¡×‘×™×¨. ×‘×¡×™×•× ×”×–××Ÿ ×ª×§×‘×œ×• ×”×•×“×¢×” ××•×˜×•××˜×™×ª.
            </div>

            <div style="display:flex; gap:8px; margin-top:6px; flex-wrap:wrap;">
              <button id="startRoundBtn" class="btn btn-success">×”×ª×—×œ ×¡×™×‘×•×‘</button>
              <button id="stopRoundBtn" class="btn btn-ghost" disabled>×¡×™×•× ×¡×™×‘×•×‘</button>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:10px;">
          <h3 style="margin:0 0 6px;">× ×™×§×•×“ ×•×§×‘×•×¦×•×ª</h3>
          <div id="scoreTarget" class="status-text"></div>
          <div id="scoreboard"></div>

          <hr style="border:none; border-top:1px solid rgba(180, 169, 214, 0.5); margin:10px 8px;" />

          <h3 style="margin:0 0 6px; font-size:0.95rem;">×©×—×§× ×™× ×œ×¤×™ ×§×‘×•×¦×”</h3>
          <div id="playersByTeam" class="status-text"></div>

          <div id="host-banner-slot" style="margin-top:8px;"></div>
        </div>
      </div>
    </div>

    <!-- ××¦×‘ ×©×—×§×Ÿ ×¢×‘×•×¨ ×”×× ×”×œ â€“ ×‘××•×ª×• ×“×£ ×¢× ××•×ª×• socket -->
    <div id="playerMode" class="hidden">
      <!-- ×›×¨×˜×™×¡ ×”×’×“×¨×•×ª ×©×—×§×Ÿ -->
      <div class="card">
        <h3 style="margin:0 0 6px;">×× ×™ ×›×©×—×§×Ÿ</h3>
        <p class="status-text" style="margin-bottom:8px;">
          ×›××Ÿ ×ª×’×“×™×¨ ××ª ×”×©× ×•×”×§×‘×•×¦×” ×©×œ×š ×›×©×—×§×Ÿ. ×›×©×ª×œ×—×¥ ×¢×œ ×”×›×¤×ª×•×¨, ×ª×¦×˜×¨×£ ×œ××©×—×§ ×›×©×—×§×Ÿ ×¨×’×™×œ
          ×¢× ××•×ª×• ×—×™×‘×•×¨, ×•×ª×•×›×œ ×œ×¢×‘×•×¨ ×‘×™×Ÿ ××¡×š ×”×©×—×§×Ÿ ×œ××¡×š ×”× ×™×”×•×œ ×‘×œ×—×™×¦×” ×¢×œ ×”×œ×©×•× ×™×•×ª.
        </p>

        <div class="row-2">
          <div class="field">
            <label for="hostPlayerName">×”×©× ×©×œ×™ ×‘×ª×•×¨ ×©×—×§×Ÿ</label>
            <input id="hostPlayerName" type="text" placeholder="×œ××©×œ: ××©×” / × ×•×¢× / ×©×¨×•×Ÿ" />
            <div class="inline-note">
              ×× ×ª×©××™×¨ ×¨×™×§, × ×©×ª××© ×‘×©× ×”×× ×”×œ ×©×”×–× ×ª ×œ××¢×œ×”.
            </div>
          </div>
          <div class="field">
            <label for="hostPlayerTeamSelect">×”×§×‘×•×¦×” ×©×œ×™</label>
            <select id="hostPlayerTeamSelect">
              <option value="">×‘×—×¨ ×§×‘×•×¦×”...</option>
            </select>
            <div class="inline-note">
              ×ª×•×›×œ ×œ×©× ×•×ª ×§×‘×•×¦×” ×œ×¤× ×™ ×©××ª×” ××¦×˜×¨×£, ×›×œ ×¢×•×“ ×”××©×—×§ ×¢×“×™×™×Ÿ ×œ× ×”×ª×—×™×œ ×‘×¨×¦×™× ×•×ª.
            </div>
          </div>
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
          <div id="playerJoinStatus" class="status-text status-muted">
            ×¢×“×™×™×Ÿ ×œ× ×”×¦×˜×¨×¤×ª ×œ××©×—×§ ×›×©×—×§×Ÿ.
          </div>
          <button id="openPlayerViewBtn" class="btn btn-success">
            âœ… ×©××•×¨ ×•×”×¦×˜×¨×£ ×›×©×—×§×Ÿ
          </button>
        </div>
      </div>

      <!-- ×›×¨×˜×™×¡ ××¦×‘ ×”××©×—×§ ×›×¤×™ ×©×”×× ×”×œ-×©×—×§×Ÿ ×¨×•××” ××•×ª×• -->
      <div class="card" id="hostPlayerGameCard" style="display:none;">
        <div class="card-header">
          <div>
            <h3 style="margin:0 0 4px;">××¦×‘ ×”××©×—×§ (×× ×™ ×›×©×—×§×Ÿ)</h3>
            <p class="card-subtitle" id="hostPlayerGameInfo">
              ×ª×¨××” ×›××Ÿ ××ª ××¦×‘ ×”××©×—×§, ×”×§×‘×•×¦×” ×©×œ×š, ×•×”×˜×™×™××¨ ×©×œ ×”×¡×™×‘×•×‘.
            </p>
          </div>
          <div class="pill">
            <span class="label">×§×•×“</span>
            <span class="value" id="hostPlayerGameCode">----</span>
          </div>
        </div>

        <div class="grid-2">
          <div>
            <div class="section-title">×”×§×‘×•×¦×” ×©×œ×™</div>
            <div id="hostPlayerTeamName" class="status-text"></div>
            <div id="hostPlayerTeamPlayers" class="status-text" style="margin-top:4px;"></div>

            <hr class="divider-soft" />

            <div class="section-title">× ×™×§×•×“ ×›×•×œ×œ</div>
            <div id="hostPlayerScoreboard" class="status-text"></div>
          </div>

          <div>
            <div class="section-title">×˜×™×™××¨ ×¡×™×‘×•×‘</div>
            <div id="hostPlayerBigTimer" class="big-timer">×˜×™×™××¨: --:--</div>

            <div id="hostRoundStatusPlayer" class="status-text" style="margin-top:4px;">
              ×›××Ÿ ×ª×¨××” ××™ ×”××¡×‘×™×¨ ×•××” ××¦×‘ ×”×¡×™×‘×•×‘.
            </div>

            <div id="hostPresenterSection" class="hidden" style="margin-top:10px;">
              <div class="section-title">×× ×™ ×”××¡×‘×™×¨/×”</div>
              <div id="hostPresenterWord" class="presenter-word">××™×œ×” ×ª×•×¤×™×¢ ×›××Ÿ</div>
              <div id="hostPresenterCategory" class="presenter-category"></div>

              <div class="presenter-actions">
                <button id="hostBtnCorrect" class="btn btn-success">
                  âœ… × ×›×•×Ÿ Â· × ×§×•×“×”
                </button>
                <button id="hostBtnSkip" class="btn presenter-btn-secondary btn-secondary">
                  â­ ×“×™×œ×•×’ / ×œ× × ×›×•×Ÿ
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ×›×¤×ª×•×¨×™× ×¦×¤×™× ×œ××¢×‘×¨ ××”×™×¨ ×‘×™×Ÿ ××¦×‘×™ ×× ×”×œ/×©×—×§×Ÿ -->
  <button id="fabToPlayer" type="button" class="floating-switch-btn">
    ğŸ® ××¢×‘×¨ ×œ××¦×‘ ×©×—×§×Ÿ
  </button>
  <button id="fabToHost" type="button" class="floating-switch-btn hidden">
    ğŸ‘‘ ××¢×‘×¨ ×œ××¦×‘ ×× ×”×œ
  </button>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const createGameBtn = document.getElementById("createGameBtn");
    const hostNameInput = document.getElementById("hostName");
    const targetScoreInput = document.getElementById("targetScore");
    const roundSecondsInput = document.getElementById("roundSeconds");
    const teamANameInput = document.getElementById("teamAName");
    const teamBNameInput = document.getElementById("teamBName");
    const teamCNameInput = document.getElementById("teamCName");
    const teamDNameInput = document.getElementById("teamDName");
    const teamENameInput = document.getElementById("teamEName");

    const hostStatus = document.getElementById("hostStatus");
    const hostGameStatus = document.getElementById("hostGameStatus");
    const gameStatusLabel = document.getElementById("gameStatusLabel");
    const gameCodeLabel = document.getElementById("gameCodeLabel");
    const viewModeLabel = document.getElementById("viewModeLabel");
    const roomsSummaryLabel = document.getElementById("roomsSummaryLabel");

    const gameCodeRow = document.getElementById("gameCodeRow");
    const gameCodeDisplay = document.getElementById("gameCodeDisplay");
    const roundStatusEl = document.getElementById("roundStatus");
    const roundTimerEl = document.getElementById("roundTimer");

    const roundTeamSelect = document.getElementById("roundTeamSelect");
    const roundSecondsInline = document.getElementById("roundSecondsInline");
    const explainerSelect = document.getElementById("explainerSelect");
    const startRoundBtn = document.getElementById("startRoundBtn");
    const stopRoundBtn = document.getElementById("stopRoundBtn");

    const inviteTeamSelect = document.getElementById("inviteTeamSelect");
    const whatsappInviteBtn = document.getElementById("whatsappInviteBtn");

    const scoreboardEl = document.getElementById("scoreboard");
    const scoreTargetEl = document.getElementById("scoreTarget");
    const playersByTeamEl = document.getElementById("playersByTeam");
    const hostBannerSlot = document.getElementById("host-banner-slot");
    const hostLogoEl = document.getElementById("host-logo");

    const tabHost = document.getElementById("tabHost");
    const tabPlayer = document.getElementById("tabPlayer");
    const hostMode = document.getElementById("hostMode");
    const playerMode = document.getElementById("playerMode");
    const fabToPlayer = document.getElementById("fabToPlayer");
    const fabToHost = document.getElementById("fabToHost");

    // ××¦×‘ ×©×—×§×Ÿ (×× ×™)
    const hostPlayerNameInput = document.getElementById("hostPlayerName");
    const hostPlayerTeamSelect = document.getElementById("hostPlayerTeamSelect");
    const openPlayerViewBtn = document.getElementById("openPlayerViewBtn");
    const playerJoinStatus = document.getElementById("playerJoinStatus");

    const hostPlayerGameCard = document.getElementById("hostPlayerGameCard");
    const hostPlayerGameCodeEl = document.getElementById("hostPlayerGameCode");
    const hostPlayerGameInfo = document.getElementById("hostPlayerGameInfo");
    const hostPlayerTeamNameEl = document.getElementById("hostPlayerTeamName");
    const hostPlayerTeamPlayersEl = document.getElementById("hostPlayerTeamPlayers");
    const hostPlayerScoreboardEl = document.getElementById("hostPlayerScoreboard");
    const hostRoundStatusPlayerEl = document.getElementById("hostRoundStatusPlayer");
    const hostPlayerBigTimerEl = document.getElementById("hostPlayerBigTimer");
    const hostPresenterSection = document.getElementById("hostPresenterSection");
    const hostPresenterWordEl = document.getElementById("hostPresenterWord");
    const hostPresenterCategoryEl = document.getElementById("hostPresenterCategory");
    const hostBtnCorrect = document.getElementById("hostBtnCorrect");
    const hostBtnSkip = document.getElementById("hostBtnSkip");

    // state ×œ×©×—×§×Ÿ-×× ×”×œ
    let isHostAlsoPlayer = false;
    let hostPlayerClientId = null;
    let hostPlayerTeamId = null;
    let hostCurrentWord = null;
    let hostCurrentCategory = "";
    let hostLastRoundKey = null;
    let hostIsCurrentExplainer = false;

    function formatTime(seconds) {
      const s = Math.max(0, Math.floor(seconds || 0));
      const m = Math.floor(s / 60).toString().padStart(2, "0");
      const ss = (s % 60).toString().padStart(2, "0");
      return m + ":" + ss;
    }

    function collectTeamNames() {
      const result = {};
      const tA = (teamANameInput.value || "").trim();
      const tB = (teamBNameInput.value || "").trim();
      const tC = (teamCNameInput.value || "").trim();
      const tD = (teamDNameInput.value || "").trim();
      const tE = (teamENameInput.value || "").trim();

      if (tA) result["A"] = tA;
      if (tB) result["B"] = tB;
      if (tC) result["C"] = tC;
      if (tD) result["D"] = tD;
      if (tE) result["E"] = tE;

      return result;
    }

    let currentGameCode = null;
    let currentGameState = null;
    let currentRoundSeconds = null;

    function buildPlayerInviteLink(gameCode, teamId, teamName) {
      const loc = window.location;
      const baseUrl = `${loc.protocol}//${loc.host}/player.html`;
      const params = new URLSearchParams();
      params.set("code", gameCode);
      if (teamId) params.set("team", teamId);
      if (teamName) params.set("teamName", teamName);
      return `${baseUrl}?${params.toString()}`;
    }

    function updateRoomsSummary() {
      if (!currentGameState) {
        roomsSummaryLabel.textContent = "-";
        return;
      }
      const playersMap = currentGameState.playersByClientId || {};
      const totalPlayers = Object.keys(playersMap).length;
      roomsSummaryLabel.textContent = `${totalPlayers} ×©×—×§× ×™× ×‘×—×“×¨`;
    }

    if (createGameBtn) {
      createGameBtn.addEventListener("click", () => {
        const hostName = (hostNameInput.value || "").trim();
        if (!hostName) {
          hostStatus.textContent = "× × ×œ×”×–×™×Ÿ ×©× ×œ×× ×”×œ ×”××©×—×§.";
          hostStatus.classList.remove("status-ok");
          hostStatus.classList.add("status-error");
          return;
        }

        const targetScoreVal = parseInt(targetScoreInput.value, 10) || 40;
        const roundSecondsVal = parseInt(roundSecondsInput.value, 10) || 60;
        const teamNames = collectTeamNames();

        hostStatus.textContent = "×™×•×¦×¨ ××©×—×§...";
        hostStatus.classList.remove("status-error");
        hostStatus.classList.remove("status-ok");

        socket.emit(
          "createGame",
          {
            hostName,
            targetScore: targetScoreVal,
            defaultRoundSeconds: roundSecondsVal,
            categories: [],
            teamNames,
          },
          (resp) => {
            if (!resp || !resp.ok) {
              hostStatus.textContent =
                (resp && resp.error) || "×©×’×™××” ×‘×™×¦×™×¨×ª ×”××©×—×§.";
              hostStatus.classList.add("status-error");
              return;
            }

            const { gameCode, game } = resp;
            currentGameCode = gameCode;
            currentGameState = game;

            hostStatus.textContent = `×”××©×—×§ × ×•×¦×¨ ×‘×”×¦×œ×—×”. ×§×•×“ ×”××©×—×§: ${gameCode}.`;
            hostStatus.classList.remove("status-error");
            hostStatus.classList.add("status-ok");

            hostGameStatus.textContent = "××©×—×§ ×¤×¢×™×œ";
            gameStatusLabel.textContent = "××©×—×§ ×¤×¢×™×œ";
            gameCodeLabel.textContent = gameCode;
            viewModeLabel.textContent = "××¡×š ×× ×”×œ";

            if (gameCodeRow) {
              gameCodeRow.classList.remove("hidden");
              gameCodeDisplay.textContent = gameCode;
            }

            if (roundSecondsInline) {
              roundSecondsInline.value = game.defaultRoundSeconds || roundSecondsVal;
            }

            updateRoomsSummary();
            renderGameState(game);
          }
        );
      });
    }

    if (document.getElementById("copyGameLinkBtn")) {
      document
        .getElementById("copyGameLinkBtn")
        .addEventListener("click", () => {
          if (!currentGameCode) {
            alert("××™×Ÿ ××©×—×§ ×¤×¢×™×œ ×›×¨×’×¢.");
            return;
          }
          const link = buildPlayerInviteLink(currentGameCode, "", "");
          navigator.clipboard
            .writeText(link)
            .then(() => {
              hostStatus.textContent =
                "×§×™×©×•×¨ ×”×©×—×§×Ÿ ×”×•×¢×ª×§. ×©×œ×— ××•×ª×• ×‘×•×•××˜×¡××¤ ××• ×‘×›×œ ×“×¨×š ×©×ª×¨×¦×”.";
              hostStatus.classList.remove("status-error");
              hostStatus.classList.add("status-ok");
            })
            .catch(() => {
              alert(
                "×œ× ×”×¦×œ×—× ×• ×œ×”×¢×ª×™×§ ××ª ×”×§×™×©×•×¨. × ×¡×” ×œ×¡××Ÿ ×•×œ×”×¢×ª×™×§ ×™×“× ×™×ª."
              );
            });
        });
    }

    if (whatsappInviteBtn) {
      whatsappInviteBtn.addEventListener("click", () => {
        if (!currentGameCode || !currentGameState) {
          alert("××™×Ÿ ××©×—×§ ×¤×¢×™×œ ×›×¨×’×¢. ×¦×•×¨ ××©×—×§ ×œ×¤× ×™ ×©×œ×™×—×ª ×”×–×× ×•×ª.");
          return;
        }
        const teamId = inviteTeamSelect.value;
        if (!teamId) {
          alert("×‘×—×¨ ×§×‘×•×¦×” ×œ×”×–×× ×”.");
          return;
        }

        const teams = currentGameState.teams || {};
        const team = teams[teamId];
        const teamName = team ? team.name : `×§×‘×•×¦×” ${teamId}`;
        const link = buildPlayerInviteLink(
          currentGameCode,
          teamId,
          teamName
        );

        const text = `×”×¦×˜×¨×¤×• ×œ××©×—×§ ××™×œ×× ×™×”! ğŸ‰\n\n×§×•×“ ×”××©×—×§: ${currentGameCode}\n×§×‘×•×¦×”: ${teamName}\n\n×œ×—×¦×• ×›××Ÿ ×œ×”×¦×˜×¨×¤×•×ª:\n${link}`;
        const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
        window.open(url, "_blank");
      });
    }

    if (document.getElementById("endGameBtn")) {
      document.getElementById("endGameBtn").addEventListener("click", () => {
        if (!currentGameCode) {
          alert("××™×Ÿ ××©×—×§ ×¤×¢×™×œ ×›×¨×’×¢.");
          return;
        }
        if (!confirm("×œ×¡×™×™× ××ª ×”××©×—×§? ×›×œ ×”× ×™×§×•×“ ×•×”×—×“×¨ ×™×™×¡×’×¨×•.")) return;

        socket.emit("endGame", { gameCode: currentGameCode }, (resp) => {
          if (!resp || !resp.ok) {
            alert((resp && resp.error) || "×©×’×™××” ×‘×¡×™×•× ×”××©×—×§.");
            return;
          }

          alert("×”××©×—×§ × ×¡×’×¨. ××¤×©×¨ ×œ×™×¦×•×¨ ××©×—×§ ×—×“×© ×‘×›×œ ×¨×’×¢.");
          currentGameCode = null;
          currentGameState = null;
          currentRoundSeconds = null;

          hostGameStatus.textContent = "××™×Ÿ ××©×—×§ ×¤×¢×™×œ";
          gameStatusLabel.textContent = "××™×Ÿ ××©×—×§ ×¤×¢×™×œ";
          gameCodeLabel.textContent = "- - - -";
          viewModeLabel.textContent = "××¡×š ×× ×”×œ";
          hostStatus.textContent = "×”××©×—×§ × ×¡×’×¨. ××¤×©×¨ ×œ×™×¦×•×¨ ××©×—×§ ×—×“×©.";
          hostStatus.classList.remove("status-error");
          hostStatus.classList.add("status-ok");

          gameCodeRow.classList.add("hidden");
          gameCodeDisplay.textContent = "----";
          roundStatusEl.textContent =
            '×¢×•×“ ×œ× ×”×ª×—×œ×ª× ×¡×™×‘×•×‘. ×‘×—×¨ ×§×‘×•×¦×” ×•××¡×‘×™×¨ ×•×œ×—×¥ ×¢×œ "×”×ª×—×œ ×¡×™×‘×•×‘".';
          roundTimerEl.textContent = "--:--";
          roundTeamSelect.innerHTML =
            '<option value="">×‘×—×¨ ×§×‘×•×¦×” ×œ×¡×™×‘×•×‘...</option>';
          explainerSelect.innerHTML =
            '<option value="">×‘×—×™×¨×ª ××¡×‘×™×¨/×” ××ª×•×š ×”×§×‘×•×¦×”</option>';
          inviteTeamSelect.innerHTML =
            '<option value="">×‘×—×¨ ×§×‘×•×¦×”...</option>';

          scoreboardEl.innerHTML = "";
          scoreTargetEl.textContent = "";
          playersByTeamEl.innerHTML = "";

          stopRoundBtn.disabled = true;
          startRoundBtn.disabled = false;
          roomsSummaryLabel.textContent = "-";
        });
      });
    }

    if (scoreboardEl) {
      scoreboardEl.addEventListener("click", (ev) => {
        const btn = ev.target.closest("button[data-team-id][data-delta]");
        if (!btn || !currentGameCode) return;

        const teamId = btn.getAttribute("data-team-id");
        const delta = parseInt(btn.getAttribute("data-delta"), 10) || 0;

        socket.emit(
          "updateScore",
          { gameCode: currentGameCode, teamId, delta },
          (resp) => {
            if (!resp || !resp.ok) {
              hostStatus.textContent =
                (resp && resp.error) || "×©×’×™××” ×‘×¢×“×›×•×Ÿ ×”× ×™×§×•×“.";
              hostStatus.classList.add("status-error");
              return;
            }
            hostStatus.textContent = "×”× ×™×§×•×“ ×¢×•×“×›×Ÿ.";
            hostStatus.classList.remove("status-error");
            hostStatus.classList.add("status-ok");
            renderGameState(resp.game);
          }
        );
      });
    }

    if (startRoundBtn) {
      startRoundBtn.addEventListener("click", () => {
        if (!currentGameCode || !currentGameState) {
          hostStatus.textContent = "××™×Ÿ ××©×—×§ ×¤×¢×™×œ. ×¦×•×¨ ××©×—×§ ×§×•×“×.";
          hostStatus.classList.add("status-error");
          return;
        }

        const teamId = roundTeamSelect.value || "";
        if (!teamId) {
          hostStatus.textContent = "× × ×œ×‘×—×•×¨ ×§×‘×•×¦×” ×œ×¡×™×‘×•×‘.";
          hostStatus.classList.add("status-error");
          return;
        }

        const roundSecondsVal =
          parseInt(roundSecondsInline.value, 10) ||
          parseInt(roundSecondsInput.value, 10) ||
          currentGameState.defaultRoundSeconds ||
          60;

        const explainerClientId =
          explainerSelect && explainerSelect.value
            ? explainerSelect.value
            : null;

        socket.emit(
          "startRound",
          {
            gameCode: currentGameCode,
            teamId,
            roundSeconds: roundSecondsVal,
            explainerClientId,
          },
          (resp) => {
            if (!resp || !resp.ok) {
              hostStatus.textContent =
                (resp && resp.error) || "×©×’×™××” ×‘×”×ª×—×œ×ª ×”×¡×™×‘×•×‘.";
              return;
            }
            hostStatus.textContent =
              "×”×¡×™×‘×•×‘ ×”×ª×—×™×œ. ×”×˜×™×™××¨ ×•×”××¦×‘ ×™×ª×¢×“×›× ×• ×œ×¤×™ ×”×©×¨×ª.";
          }
        );
      });
    }

    if (stopRoundBtn) {
      stopRoundBtn.addEventListener("click", () => {
        if (!currentGameCode) return;
        socket.emit("endRound", { gameCode: currentGameCode }, (resp) => {
          if (resp && !resp.ok) {
            hostStatus.textContent = resp.error || "×©×’×™××” ×‘×¡×™×•× ×”×¡×™×‘×•×‘.";
            return;
          }
          hostStatus.textContent = "×”×¡×™×‘×•×‘ ×”×¡×ª×™×™×.";
        });
      });
    }

    // ××¢×‘×¨ ×‘×™×Ÿ ×˜××‘ ×× ×”×œ ×œ×˜××‘ ×©×—×§×Ÿ (×× ×™)
    if (tabHost && tabPlayer && hostMode && playerMode) {
      const showHostMode = () => {
        tabHost.classList.add("active");
        tabPlayer.classList.remove("active");
        hostMode.classList.remove("hidden");
        playerMode.classList.add("hidden");
        if (fabToPlayer && fabToHost) {
          fabToPlayer.classList.remove("hidden");
          fabToHost.classList.add("hidden");
        }
        viewModeLabel.textContent = "××¡×š ×× ×”×œ";
      };

      const showPlayerMode = () => {
        tabPlayer.classList.add("active");
        tabHost.classList.remove("active");
        hostMode.classList.add("hidden");
        playerMode.classList.remove("hidden");
        if (fabToPlayer && fabToHost) {
          fabToPlayer.classList.add("hidden");
          fabToHost.classList.remove("hidden");
        }
        viewModeLabel.textContent = "××¦×‘ ×©×—×§×Ÿ (×× ×™)";
      };

      tabHost.addEventListener("click", showHostMode);
      tabPlayer.addEventListener("click", showPlayerMode);

      // ×‘×¨×™×¨×ª ××—×“×œ â€“ ××¦×‘ ×× ×”×œ
      showHostMode();
    }

    // ×”×¦×˜×¨×¤×•×ª ×”×× ×”×œ ×›×©×—×§×Ÿ
    if (openPlayerViewBtn) {
      openPlayerViewBtn.addEventListener("click", () => {
        if (!currentGameCode) {
          alert("××™×Ÿ ××©×—×§ ×¤×¢×™×œ ×›×¨×’×¢. ×§×•×“× ×¦×•×¨ ××©×—×§.");
          return;
        }

        const name =
          (hostPlayerNameInput && hostPlayerNameInput.value.trim()) ||
          (hostNameInput && hostNameInput.value.trim());

        if (!name) {
          alert("× × ×œ×”×–×™×Ÿ ×©× ×œ×©×—×§×Ÿ.");
          return;
        }

        const teamId = hostPlayerTeamSelect
          ? hostPlayerTeamSelect.value
          : "";
        if (!teamId) {
          alert("× × ×œ×‘×—×•×¨ ×§×‘×•×¦×”.");
          return;
        }

        socket.emit(
          "joinGame",
          { gameCode: currentGameCode, name, teamId },
          (resp) => {
            if (!resp || !resp.ok) {
              playerJoinStatus.textContent =
                (resp && resp.error) || "×©×’×™××” ×‘×”×¦×˜×¨×¤×•×ª ×œ××©×—×§.";
              playerJoinStatus.classList.remove("status-ok");
              playerJoinStatus.classList.add("status-error");
              return;
            }

            isHostAlsoPlayer = true;
            hostPlayerClientId = resp.clientId;
            hostPlayerTeamId = resp.teamId;

            playerJoinStatus.textContent = `×”×¦×˜×¨×¤×ª ×‘×”×¦×œ×—×” ×œ×§×‘×•×¦×” "${resp.teamId}". ×ª×•×›×œ ×œ×¨××•×ª ××ª ××¦×‘ ×”××©×—×§ ×›××Ÿ ×•×œ×©×—×§ ×›××• ×›×œ ×©×—×§×Ÿ ××—×¨.`;
            playerJoinStatus.classList.remove("status-error");
            playerJoinStatus.classList.add("status-ok");

            hostPlayerGameCard.style.display = "block";
            hostPlayerGameCodeEl.textContent = currentGameCode || "----";

            renderGameState(resp.game);
          }
        );
      });
    }

    function renderGameState(game) {
      if (!game) return;
      currentGameState = game;
      currentGameCode = game.code || currentGameCode || null;

      const teams = game.teams || {};
      const playersMap = game.playersByClientId || {};
      const teamIds = Object.keys(teams);
      const targetScoreVal = game.targetScore || 40;

      hostGameStatus.textContent = "××©×—×§ ×¤×¢×™×œ";
      gameStatusLabel.textContent = "××©×—×§ ×¤×¢×™×œ";
      gameCodeLabel.textContent = game.code || "- - - -";

      if (gameCodeRow && game.code) {
        gameCodeRow.classList.remove("hidden");
        gameCodeDisplay.textContent = game.code;
      }

      const roundSec = game.defaultRoundSeconds || 60;
      roundSecondsLabel.textContent = `${roundSec} ×©× ×™×•×ª`;

      if (roundSecondsInput) {
        roundSecondsInput.value = roundSec;
      }
      if (roundSecondsInline && !roundSecondsInline.value) {
        roundSecondsInline.value = roundSec;
      }

      scoreTargetEl.textContent = `×”××©×—×§ ××¡×ª×™×™× ×›××©×¨ ××—×ª ×”×§×‘×•×¦×•×ª ××’×™×¢×” ×œ-${targetScoreVal} × ×§×•×“×•×ª.`;

      roundTeamSelect.innerHTML =
        '<option value="">×‘×—×¨ ×§×‘×•×¦×” ×œ×¡×™×‘×•×‘...</option>';
      inviteTeamSelect.innerHTML =
        '<option value="">×‘×—×¨ ×§×‘×•×¦×”...</option>';

      scoreboardEl.innerHTML = "";
      let bestTeamId = null;
      let bestScore = -Infinity;

      teamIds.forEach((tid) => {
        const t = teams[tid];
        if (!t) return;

        const liPlayers = (t.players || [])
          .map((cid) => playersMap[cid])
          .filter(Boolean);

        if (t.score > bestScore) {
          bestScore = t.score;
          bestTeamId = tid;
        }

        const row = document.createElement("div");
        row.className = "score-row";

        const nameSpan = document.createElement("div");
        nameSpan.className = "score-row-name";
        nameSpan.textContent = t.name || `×§×‘×•×¦×” ${tid}`;

        const pointsSpan = document.createElement("div");
        pointsSpan.className = "score-row-points";
        pointsSpan.textContent = `${t.score || 0} × ×§'`;

        const controls = document.createElement("div");
        controls.className = "score-row-controls";

        const btnMinus = document.createElement("button");
        btnMinus.className = "btn btn-ghost btn-small";
        btnMinus.textContent = "âˆ’ × ×§×•×“×”";
        btnMinus.setAttribute("data-team-id", tid);
        btnMinus.setAttribute("data-delta", "-1");

        const btnPlus = document.createElement("button");
        btnPlus.className = "btn btn-small btn-success";
        btnPlus.textContent = "+ × ×§×•×“×”";
        btnPlus.setAttribute("data-team-id", tid);
        btnPlus.setAttribute("data-delta", "1");

        controls.appendChild(btnMinus);
        controls.appendChild(btnPlus);

        row.appendChild(nameSpan);
        row.appendChild(pointsSpan);
        row.appendChild(controls);
        scoreboardEl.appendChild(row);

        const optRound = document.createElement("option");
        optRound.value = tid;
        optRound.textContent = t.name || `×§×‘×•×¦×” ${tid}`;
        roundTeamSelect.appendChild(optRound);

        const optInvite = document.createElement("option");
        optInvite.value = tid;
        optInvite.textContent = t.name || `×§×‘×•×¦×” ${tid}`;
        inviteTeamSelect.appendChild(optInvite);
      });

      let playersHtml = "";
      if (teamIds.length === 0) {
        playersHtml =
          "<p class='players-by-team-list empty'>×œ× ×”×•×’×“×¨×• ×¢×“×™×™×Ÿ ×§×‘×•×¦×•×ª.</p>";
      } else {
        playersHtml += "<div class='players-by-team-list'>";
        teamIds.forEach((tid) => {
          const t = teams[tid];
          if (!t) return;
          const pList = (t.players || [])
            .map((cid) => playersMap[cid])
            .filter(Boolean);

          playersHtml += `<h4>${t.name || `×§×‘×•×¦×” ${tid}`}</h4>`;
          if (pList.length === 0) {
            playersHtml +=
              "<p class='empty'>××™×Ÿ ×¢×“×™×™×Ÿ ×©×—×§× ×™× ×‘×§×‘×•×¦×” ×–×•.</p>";
          } else {
            playersHtml += "<ul>";
            pList.forEach((p) => {
              playersHtml += `<li>ğŸ‘¤ ${p.name}</li>`;
            });
            playersHtml += "</ul>";
          }
        });
        playersHtml += "</div>";
      }
      playersByTeamEl.innerHTML = playersHtml;

      let roundStatusText = "××™×Ÿ ×¡×™×‘×•×‘ ×¤×¢×™×œ ×›×¨×’×¢.";
      let roundSecondsLeft = null;
      let roundActive = false;
      let explainerName = "";
      let explainerTeamId = "";
      let explainerTeamName = "";

      if (
        game.currentRound &&
        game.currentRound.active !== false &&
        game.currentRound.isActive !== false
      ) {
        roundActive = true;
        roundSecondsLeft = game.currentRound.secondsLeft || 0;
        explainerName = game.currentRound.explainerName || "";
        explainerTeamId = game.currentRound.teamId || "";
        if (explainerTeamId && teams[explainerTeamId]) {
          explainerTeamName = teams[explainerTeamId].name || "";
        }
      }

      if (!roundActive) {
        roundStatusText =
          '×›×¨×’×¢ ××™×Ÿ ×¡×™×‘×•×‘ ×¤×¢×™×œ. ×‘×—×¨ ×§×‘×•×¦×” ×•××¡×‘×™×¨ ×•×œ×—×¥ ×¢×œ "×”×ª×—×œ ×¡×™×‘×•×‘".';
        roundStateLabel.textContent = "××™×Ÿ ×¡×™×‘×•×‘ ×¤×¢×™×œ";
        roundTimerEl.textContent = "--:--";
        stopRoundBtn.disabled = true;
        startRoundBtn.disabled = !currentGameCode;
      } else {
        roundStateLabel.textContent = "×¡×™×‘×•×‘ ×¤×¢×™×œ";
        roundTimerEl.textContent = formatTime(roundSecondsLeft);
        stopRoundBtn.disabled = false;
        startRoundBtn.disabled = true;

        const explainerTeamText =
          explainerTeamName ||
          (explainerTeamId ? `×§×‘×•×¦×” ${explainerTeamId}` : "");

        let msg = "×¡×™×‘×•×‘ ×¤×¢×™×œ ×›×¨×’×¢.";
        if (explainerName && explainerTeamText) {
          msg = `×¢×›×©×™×• ××¡×‘×™×¨/×”: <strong>${explainerName}</strong> (${explainerTeamText}).`;
        } else if (explainerName) {
          msg = `×¢×›×©×™×• ××¡×‘×™×¨/×”: <strong>${explainerName}</strong>.`;
        }

        if (roundSecondsLeft !== null) {
          msg += ` Â· × ×©××¨×• ×›Ö¾${roundSecondsLeft} ×©× ×™×•×ª.`;
        }

        roundStatusText = msg;
      }

      roundStatusEl.innerHTML = roundStatusText;

      updateRoomsSummary();

      if (isHostAlsoPlayer && hostPlayerGameCard) {
        hostPlayerGameCard.style.display = "block";
        hostPlayerGameCodeEl.textContent = currentGameCode || "----";

        if (hostPlayerTeamId && teams[hostPlayerTeamId]) {
          const t = teams[hostPlayerTeamId];
          hostPlayerTeamNameEl.innerHTML = `<strong>${
            t.name || `×§×‘×•×¦×” ${hostPlayerTeamId}`
          }</strong>`;
          const pList = (t.players || [])
            .map((cid) => playersMap[cid])
            .filter(Boolean);
          if (pList.length === 0) {
            hostPlayerTeamPlayersEl.innerHTML =
              "<span class='status-muted'>××™×Ÿ ×¢×“×™×™×Ÿ ×©×—×§× ×™× × ×•×¡×¤×™× ×‘×§×‘×•×¦×” ×©×œ×š.</span>";
          } else {
            hostPlayerTeamPlayersEl.innerHTML =
              "<span class='status-soft'>×©×—×§× ×™× ×‘×§×‘×•×¦×”:</span> " +
              pList.map((p) => p.name).join(", ");
          }
        } else {
          hostPlayerTeamNameEl.innerHTML =
            "<span class='status-muted'>×œ× ×–×•×”×ª×” ×§×‘×•×¦×” ×œ×©×—×§×Ÿ.</span>";
          hostPlayerTeamPlayersEl.innerHTML = "";
        }

        const parts = [];
        teamIds.forEach((tid) => {
          const t = teams[tid];
          if (!t) return;
          parts.push(`${t.name || `×§×‘×•×¦×” ${tid}`}: ${t.score || 0} × ×§'`);
        });
        hostPlayerScoreboardEl.textContent =
          parts.length > 0 ? parts.join(" Â· ") : "××™×Ÿ ×¢×“×™×™×Ÿ × ×™×§×•×“.";

        if (roundActive) {
          hostPlayerBigTimerEl.textContent =
            "×˜×™×™××¨: " + formatTime(roundSecondsLeft);
        } else {
          hostPlayerBigTimerEl.textContent = "×˜×™×™××¨: --:--";
        }

        if (roundActive) {
          const explainerTeamText =
            explainerTeamName ||
            (explainerTeamId ? `×§×‘×•×¦×” ${explainerTeamId}` : "");
          let msgPlayer = "×¡×™×‘×•×‘ ×¤×¢×™×œ ×›×¨×’×¢.";
          if (explainerName && explainerTeamText) {
            msgPlayer = `×¢×›×©×™×• ××¡×‘×™×¨/×”: <strong>${explainerName}</strong> (${explainerTeamText}).`;
          } else if (explainerName) {
            msgPlayer = `×¢×›×©×™×• ××¡×‘×™×¨/×”: <strong>${explainerName}</strong>.`;
          }
          if (roundSecondsLeft !== null) {
            msgPlayer += ` Â· × ×©××¨×• ×›Ö¾${roundSecondsLeft} ×©× ×™×•×ª.`;
          }

          hostRoundStatusPlayerEl.innerHTML = msgPlayer;

          hostIsCurrentExplainer = !!(
            game.currentRound.explainerId &&
            hostPlayerClientId &&
            game.currentRound.explainerId === hostPlayerClientId
          );

          if (hostIsCurrentExplainer) {
            hostPresenterSection.classList.remove("hidden");
          } else {
            hostPresenterSection.classList.add("hidden");
          }
        } else {
          hostRoundStatusPlayerEl.textContent =
            "×›×¨×’×¢ ××™×Ÿ ×¡×™×‘×•×‘ ×¤×¢×™×œ. ×—×›×• ×©×× ×”×œ ×”××©×—×§ ×™×ª×—×™×œ ×¡×™×‘×•×‘ ×—×“×©.";
          hostPlayerBigTimerEl.textContent = "×˜×™×™××¨: --:--";
          hostIsCurrentExplainer = false;
          hostPresenterSection.classList.add("hidden");
        }
      }
    }

    if (hostBtnCorrect) {
      hostBtnCorrect.addEventListener("click", () => {
        if (!currentGameCode || !hostIsCurrentExplainer) return;
        socket.emit(
          "changeRoundScore",
          { gameCode: currentGameCode, delta: +1 },
          (resp) => {
            if (resp && resp.ok) {
              hostStatus.textContent = "× ×™×§×•×“ ×¢×•×“×›×Ÿ (+1).";
              hostStatus.classList.remove("status-error");
              hostStatus.classList.add("status-ok");
            }
          }
        );
        socket.emit("getNextWord", { gameCode: currentGameCode }, (resp) => {
          if (resp && resp.ok) {
            hostCurrentWord = resp.word;
            hostCurrentCategory = resp.category || "";
            hostPresenterWordEl.textContent = hostCurrentWord || "â€”";
            hostPresenterCategoryEl.textContent = hostCurrentCategory
              ? `×§×˜×’×•×¨×™×”: ${hostCurrentCategory}`
              : "";
          }
        });
      });
    }

    if (hostBtnSkip) {
      hostBtnSkip.addEventListener("click", () => {
        if (!currentGameCode || !hostIsCurrentExplainer) return;
        socket.emit(
          "changeRoundScore",
          { gameCode: currentGameCode, delta: -1 },
          (resp) => {
            if (resp && resp.ok) {
              hostStatus.textContent = "× ×™×§×•×“ ×¢×•×“×›×Ÿ (âˆ’1).";
              hostStatus.classList.remove("status-error");
              hostStatus.classList.add("status-ok");
            }
          }
        );
        socket.emit("getNextWord", { gameCode: currentGameCode }, (resp) => {
          if (resp && resp.ok) {
            hostCurrentWord = resp.word;
            hostCurrentCategory = resp.category || "";
            hostPresenterWordEl.textContent = hostCurrentWord || "â€”";
            hostPresenterCategoryEl.textContent = hostCurrentCategory
              ? `×§×˜×’×•×¨×™×”: ${hostCurrentCategory}`
              : "";
          }
        });
      });
    }

    socket.on("gameUpdated", (game) => {
      if (!game) return;
      if (!currentGameCode || game.code === currentGameCode) {
        renderGameState(game);
      }
    });

    socket.on("roundTimeUp", (data) => {
      if (!data || !data.code) return;
      if (currentGameCode && data.code !== currentGameCode) return;

      const score =
        typeof data.roundScore === "number" ? data.roundScore : null;
      const teamName =
        data.teamName || (data.teamId ? `×§×‘×•×¦×” ${data.teamId}` : "");

      let msg = "";
      if (score === null) {
        msg = "×”×¡×™×‘×•×‘ ×”×¡×ª×™×™×.";
      } else if (score <= 5) {
        msg = `×”×¡×™×‘×•×‘ ×”×¡×ª×™×™×.\n×”×§×‘×•×¦×” ${teamName} ×”×©×™×’×” ${score} × ×§×•×“×•×ª. ××¤×©×¨ ×™×•×ª×¨ ×˜×•×‘ ×‘×¡×™×‘×•×‘ ×”×‘×! ğŸ˜‰`;
      } else if (score <= 10) {
        msg = `×¡×™×‘×•×‘ ×™×¤×”!\n×”×§×‘×•×¦×” ${teamName} ×”×©×™×’×” ${score} × ×§×•×“×•×ª.`;
      } else {
        msg = `×•×•××•! ×¡×™×‘×•×‘ ××¦×•×™×Ÿ!\n×”×§×‘×•×¦×” ${teamName} ×”×©×™×’×” ${score} × ×§×•×“×•×ª! ğŸ”¥`;
      }

      alert(msg);
    });

    // --- ×›×¤×ª×•×¨×™ ××¢×‘×¨ ×¦×¤×™× ×‘×™×Ÿ ××¡×š ×× ×”×œ â†” ××¡×š ×©×—×§×Ÿ ---

    function switchToPlayerMode() {
      if (!tabPlayer || !tabHost || !hostMode || !playerMode) return;
      tabPlayer.classList.add("active");
      tabHost.classList.remove("active");
      hostMode.classList.add("hidden");
      playerMode.classList.remove("hidden");

      if (fabToPlayer) fabToPlayer.classList.add("hidden");
      if (fabToHost) fabToHost.classList.remove("hidden");

      viewModeLabel.textContent = "××¦×‘ ×©×—×§×Ÿ (×× ×™)";
    }

    function switchToHostMode() {
      if (!tabPlayer || !tabHost || !hostMode || !playerMode) return;
      tabHost.classList.add("active");
      tabPlayer.classList.remove("active");
      hostMode.classList.remove("hidden");
      playerMode.classList.add("hidden");

      if (fabToPlayer) fabToPlayer.classList.remove("hidden");
      if (fabToHost) fabToHost.classList.add("hidden");

      viewModeLabel.textContent = "××¡×š ×× ×”×œ";
    }

    if (fabToPlayer) {
      fabToPlayer.addEventListener("click", switchToPlayerMode);
    }
    if (fabToHost) {
      fabToHost.addEventListener("click", switchToHostMode);
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (fabToPlayer) fabToPlayer.classList.remove("hidden");
      if (fabToHost) fabToHost.classList.add("hidden");
    });

    // ×¨×¢× ×•×Ÿ ××¦×‘ ××©×—×§ ×›×©×—×•×–×¨×™× ×œ×˜××‘
    document.addEventListener("visibilitychange", () => {
      if (document.visibilityState === "visible" && currentGameCode) {
        socket.emit("getGameState", { gameCode: currentGameCode }, (resp) => {
          if (resp && resp.ok && resp.game) {
            renderGameState(resp.game);
          }
        });
      }
    });
  </script>
</body>
</html>
